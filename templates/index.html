{% extends "base.html" %}
{% block content %}
<h2>ğŸ“’ Quáº£n lÃ½ chi tiÃªu</h2>

<form method="post">
    <input type="date" name="date" class="input" required>
    <input type="text" name="category" class="input" placeholder="Danh má»¥c (VD: Ä‚n uá»‘ng, Mua sáº¯m)" required>
    <input type="number" name="amount" class="input" placeholder="Sá»‘ tiá»n (VND)" required>
    <textarea name="note" class="input" placeholder="Ghi chÃº (tÃ¹y chá»n)"></textarea>
    <button type="submit" class="btn">+ ThÃªm khoáº£n chi</button>
</form>

<table>
    <tr>
        <th>NgÃ y</th>
        <th>Danh má»¥c</th>
        <th>Sá»‘ tiá»n (VND)</th>
        <th>Ghi chÃº</th>
    </tr>
    {% for item in expenses %}
    <tr>
        <td>{{ item.date }}</td>
        <td>{{ item.category }}</td>
        <td>{{ "{:,.0f}".format(item.amount) }}</td>
        <td>{{ item.note }}</td>
    </tr>
    {% endfor %}
</table>

<canvas id="myChart" style="margin-top:20px;"></canvas>

<script>
const ctx = document.getElementById('myChart');
const data = {
    labels: {{ category_totals.keys() | list | safe }},
    datasets: [{
        label: 'Tá»•ng chi tiÃªu (VND)',
        data: {{ category_totals.values() | list | safe }},
        backgroundColor: '#2ab7a9'
    }]
};
new Chart(ctx, { type: 'bar', data: data });
</script>
{% endblock %}
